{"version":3,"file":"index.js","sourceRoot":"","sources":["../src/index.ts"],"names":[],"mappings":";;;AAKA,+BAWe;AA6GN,2FAvHR,gBAAU,OAuHQ;AAAE,8FAtHpB,mBAAa,OAsHoB;AAEzB,wFAtHR,aAAO,OAsHQ;AA9GhB,sDAAgG;AAChG,gDAAoF;AACpF,gDAAoF;AACpF,yCAA4E;AA8GnE,uFA9GA,eAAM,OA8GA;AAAE,wFA9GA,gBAAO,OA8GA;AAAE,uFA9GA,eAAM,OA8GA;AAAE,2FA9GA,mBAAU,OA8GA;AAAE,wFA9GA,gBAAO,OA8GA;AA7GrD,oDAAiG;AACjG,qCAAsC;AACtC,yCAAuE;AA4G9D,iGA5GA,yBAAgB,OA4GA;AAAE,sGA5GA,8BAAqB,OA4GA;AA3GhD,qCAA2C;AA0GY,8FA1G9C,oBAAa,OA0G8C;AA/F7D,KAAK,UAAU,MAAM,CAC3B,KAAa,EACb,UAAyB,EAAE;IAE3B,IAAI,IAAS,CAAC;IACd,OAAO,CAAC,KAAK,KAAK,CAAC,CAAC;IACpB,OAAO,CAAC,OAAO,KAAK,aAAO,CAAC,OAAO,CAAC;IACpC,OAAO,CAAC,IAAI,KAAK,QAAQ,CAAC;IAE1B,QAAQ,OAAO,CAAC,OAAO,EAAE;QACxB,KAAK,aAAO,CAAC,UAAU;YACtB,IAAI,OAAO,CAAC,IAAI,IAAI,QAAQ;gBAAE,MAAM,IAAI,KAAK,CAAC,mCAAmC,CAAC,CAAC;YACnF,OAAO,MAAM,IAAA,8BAAiB,EAAC,KAAK,EAAE,OAAO,CAAC,KAAK,EAAE,OAAO,CAAC,IAAI,CAAC,CAAC;YACnE,MAAM;QAEP,KAAK,aAAO,CAAC,OAAO;YACnB,IAAI,OAAO,CAAC,IAAI,IAAI,QAAQ;gBAAE,MAAM,IAAI,KAAK,CAAC,gCAAgC,CAAC,CAAC;YAChF,IAAI,OAAO,CAAC,IAAI,IAAI,QAAQ;gBAAE,IAAI,GAAG,OAAO,CAAC;YAC7C,IAAI,OAAO,CAAC,IAAI,IAAI,WAAW;gBAAE,IAAI,GAAG,UAAU,CAAC;YACnD,IAAI,OAAO,CAAC,IAAI,IAAI,QAAQ;gBAAE,IAAI,GAAG,OAAO,CAAC;YAC7C,OAAO,MAAM,IAAA,wBAAc,EAAC,KAAK,EAAE,OAAO,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;YACxD,MAAM;QAEP,KAAK,aAAO,CAAC,OAAO;YACnB,IAAI,OAAO,CAAC,IAAI,IAAI,QAAQ;gBAAE,MAAM,IAAI,KAAK,CAAC,gCAAgC,CAAC,CAAC;YAChF,IAAI,OAAO,CAAC,IAAI,IAAI,WAAW;gBAAE,IAAI,GAAG,UAAU,CAAC;YACnD,IAAI,OAAO,CAAC,IAAI,IAAI,QAAQ,IAAI,OAAO,CAAC,IAAI,IAAI,QAAQ;gBAAE,IAAI,GAAG,OAAO,CAAC;YACzE,OAAO,MAAM,IAAA,wBAAc,EAAC,KAAK,EAAE,OAAO,CAAC,KAAK,EAAE,IAAI,CAAC,CAAC;YACxD,MAAM;QAEP,KAAK,aAAO,CAAC,SAAS;YACrB,MAAM,sDAAsD,CAAC;YAC7D,MAAM;KACP;IAED,MAAM,IAAI,KAAK,CAAC,6DAA6D,CAAC,CAAC;AAChF,CAAC;AApCD,wBAoCC;AAOM,KAAK,UAAU,cAAc,CAAC,GAAW;IAC/C,GAAG,GAAG,GAAG,CAAC,IAAI,EAAE,CAAC;IACjB,IAAI,GAAG,CAAC,MAAM,KAAK,CAAC;QAAE,OAAO;IAC7B,IAAI,IAAA,0BAAgB,EAAC,GAAG,CAAC;QAAE,OAAO,aAAO,CAAC,OAAO,CAAC;IAClD,IAAI,IAAA,gCAAmB,EAAC,GAAG,CAAC;QAAE,OAAO,aAAO,CAAC,UAAU,CAAC;IACxD,IAAI,IAAA,0BAAgB,EAAC,GAAG,CAAC;QAAE,OAAO,aAAO,CAAC,OAAO,CAAC;IAClD,IAAI,IAAA,8BAAkB,EAAC,GAAG,CAAC;QAAE,OAAO,aAAO,CAAC,SAAS,CAAC;AACvD,CAAC;AAPD,wCAOC;AAYM,KAAK,UAAU,IAAI,CAAC,GAAW;IACrC,GAAG,GAAG,GAAG,CAAC,IAAI,EAAE,CAAC;IACjB,IAAI,OAAO,GAAG,MAAM,cAAc,CAAC,GAAG,CAAC,CAAC;IACxC,IAAI,CAAC,GAAG;QAAE,MAAM,WAAW,CAAC;IAC5B,IAAA,eAAQ,EAAC,qBAAqB,GAAG,yBAAyB,OAAO,EAAE,CAAC,CAAC;IAErE,QAAQ,OAAO,EAAE;QAChB,KAAK,aAAO,CAAC,UAAU;YACtB,OAAO,IAAA,4BAAe,EAAC,GAAG,CAAC,CAAC,KAAK,CAAC,CAAC,GAAG,EAAE,EAAE;gBACzC,MAAM,GAAG,CAAC;YACX,CAAC,CAAC,CAAC;QAEJ,KAAK,aAAO,CAAC,OAAO;YACnB,OAAO,IAAA,sBAAY,EAAC,GAAG,CAAC,CAAC;YACzB,MAAM;QAEP,KAAK,aAAO,CAAC,OAAO;YACnB,OAAO,IAAA,sBAAY,EAAC,GAAG,CAAC,CAAC;YACzB,MAAM;QAEP,KAAK,aAAO,CAAC,SAAS;YACrB,OAAO,IAAA,0BAAc,EAAC,GAAG,EAAE,EAAE,CAAC,CAAC;YAC/B,MAAM;KACP;IAED,MAAM,IAAI,KAAK,CAAC,iBAAiB,CAAC,CAAC;AACpC,CAAC;AA1BD,oBA0BC","sourcesContent":["/**\n * Avoxel284 2022\n * Barbara Music Module\n */\n\nimport {\n\tMusicTrack,\n\tMusicPlaylist,\n\tSearchOptions,\n\tService,\n\tAudio,\n\tAuthor,\n\tQueue,\n\tMusicTrackConstructor,\n\tMusicPlaylistConstructor,\n\tGeniusSong,\n} from \"./lib\";\nimport { SoundCloud_Info, SoundCloud_Search, SoundCloud_Validate } from \"./services/SoundCloud\";\nimport { YouTube_Info, YouTube_Search, YouTube_Validate } from \"./services/YouTube\";\nimport { Spotify_Info, Spotify_Search, Spotify_Validate } from \"./services/Spotify\";\nimport { setKey, freeKey, getKey, setKeyFile, setKeys } from \"./lib/config\";\nimport { AudioFile_Info, AudioFile_Validate, AUDIOFILE_URL_PATTERN } from \"./services/Arbitrary\";\nimport { debugLog } from \"./lib/util\";\nimport { searchGeniusSong, fetchGeniusSongLyrics } from \"./lib/genius\";\nimport { refreshTokens } from \"./lib/auth\";\n\n/**\n * Searches for tracks with given query on SoundCloud, unless other service and type is specified in search options.\n *\n * Note: For YouTube, option.type = `tracks` and `videos` are the same thing.\n *\n * @param query Search query\n * @param options Search options\n * @returns Array of MusicTrack or MusicPlaylist objects\n */\nexport async function search(\n\tquery: string,\n\toptions: SearchOptions = {}\n): Promise<MusicTrack[] | MusicPlaylist[]> {\n\tlet type: any;\n\toptions.limit ??= 1;\n\toptions.service ??= Service.youtube;\n\toptions.type ??= \"tracks\";\n\n\tswitch (options.service) {\n\t\tcase Service.soundcloud:\n\t\t\tif (options.type == \"videos\") throw new Error(\"Videos do not exist on SoundCloud\");\n\t\t\treturn await SoundCloud_Search(query, options.limit, options.type);\n\t\t\tbreak;\n\n\t\tcase Service.spotify:\n\t\t\tif (options.type == \"videos\") throw new Error(\"Videos do not exist on Spotify\");\n\t\t\tif (options.type == \"albums\") type = \"album\";\n\t\t\tif (options.type == \"playlists\") type = \"playlist\";\n\t\t\tif (options.type == \"tracks\") type = \"track\";\n\t\t\treturn await Spotify_Search(query, options.limit, type);\n\t\t\tbreak;\n\n\t\tcase Service.youtube:\n\t\t\tif (options.type == \"albums\") throw new Error(\"Albums do not exist on YouTube\");\n\t\t\tif (options.type == \"playlists\") type = \"playlist\";\n\t\t\tif (options.type == \"tracks\" || options.type == \"videos\") type = \"video\";\n\t\t\treturn await YouTube_Search(query, options.limit, type);\n\t\t\tbreak;\n\n\t\tcase Service.audiofile:\n\t\t\tthrow \"Bro really thought they could search for audio files\";\n\t\t\tbreak;\n\t}\n\n\tthrow new Error(\"Interesting how its impossible for this error to ever occur\");\n}\n\n/**\n * Validate and get the service from a given URL.\n *\n * @returns Service or undefined\n */\nexport async function serviceFromURL(url: string): Promise<Service | undefined> {\n\turl = url.trim();\n\tif (url.length === 0) return;\n\tif (YouTube_Validate(url)) return Service.youtube;\n\tif (SoundCloud_Validate(url)) return Service.soundcloud;\n\tif (Spotify_Validate(url)) return Service.spotify;\n\tif (AudioFile_Validate(url)) return Service.audiofile;\n}\n\n/**\n * Automatically matches and returns a MusicTrack or MusicPlaylist from a given service URL\n *\n * @example\n * ```\n * barbara.info(\"\").then((track) => {\n *\n * })\n * ```\n */\nexport async function info(url: string): Promise<MusicTrack | MusicPlaylist> {\n\turl = url.trim();\n\tlet service = await serviceFromURL(url);\n\tif (!url) throw \"URL empty\";\n\tdebugLog(`Getting info from ${url} :: Detected service: ${service}`);\n\n\tswitch (service) {\n\t\tcase Service.soundcloud:\n\t\t\treturn SoundCloud_Info(url).catch((err) => {\n\t\t\t\tthrow err;\n\t\t\t});\n\n\t\tcase Service.spotify:\n\t\t\treturn Spotify_Info(url);\n\t\t\tbreak;\n\n\t\tcase Service.youtube:\n\t\t\treturn YouTube_Info(url);\n\t\t\tbreak;\n\n\t\tcase Service.audiofile:\n\t\t\treturn AudioFile_Info(url, {});\n\t\t\tbreak;\n\t}\n\n\tthrow new Error(\"Invalid service\");\n}\n\nexport { MusicTrack, MusicPlaylist };\nexport { SearchOptions, Audio, Author, MusicTrackConstructor, MusicPlaylistConstructor };\nexport { Service };\n// export { SoundCloud };\n// export { Spotify };\nexport { setKey, freeKey, getKey, setKeyFile, setKeys, refreshTokens };\nexport { searchGeniusSong, fetchGeniusSongLyrics, GeniusSong };\n// export { YouTube, YouTubeSearch };\n"]}